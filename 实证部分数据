
import pandas as pd
import matplotlib.pyplot as plt

# 读取包含数据的 Excel 文件
df = pd.read_excel(r'C:\Users\邓和顺\Desktop\收敛性.xlsx')
# 按照年份和区域类别分组，并计算均值
grouped = df.groupby(['year', 'region'])['co2'].mean().reset_index()

# 输出结果到 Excel 表格
grouped.to_excel('output.xlsx', index=False)

# 绘制时间趋势图
plt.figure(figsize=(10, 6))
markers = ['o', 's', '^', 'D']  # 不同区域的标记
for region, marker in zip(grouped['region'].unique(), markers):
    data = grouped[grouped['region'] == region]
    plt.plot(data['year'], data['co2'], marker=marker, label=f'区域{region}')

plt.xlabel('Year')
plt.ylabel('Carbon Emission Efficiency')
plt.legend()
plt.title('Evolution trend of urban carbon emission Efficiency in China (2011-2019)')
plt.grid(True)
plt.show()


